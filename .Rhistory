}
for(i in 1:4){
data_2021[[i]] <- qcew_api(year = 2021,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2020[[i]] <- qcew_api(year = 2020,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2019[[i]] <- qcew_api(year = 2019,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2018[[i]] <- qcew_api(year = 2018,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
QCEW <- rbind(do.call(rbind, data_2022),
do.call(rbind, data_2021),
do.call(rbind, data_2020),
do.call(rbind, data_2019),
do.call(rbind, data_2018))
##########################################################################
# Animated map of establishments
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .99))
estab <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_estabs_pct_chg) %>%
filter(oty_qtrly_estabs_pct_chg>quant_01 & oty_qtrly_estabs_pct_chg<quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "Count of Establishments")
View(estab)
names(estab)
##########################################################################
# Animated map of establishments
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .99))
estab <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_estabs_pct_chg) %>%
filter(oty_qtrly_estabs_pct_chg>quant_01 & oty_qtrly_estabs_pct_chg<quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "Count of Establishments")
names(estab) <- c("fips","year_quarter","value","Variable")
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .99))
employ <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_month2_emplvl_pct_chg) %>%
filter(oty_month2_emplvl_pct_chg>=quant_01 & oty_month2_emplvl_pct_chg<=quant_99) %>%
na.omit() %>%
distinct()  %>%
mutate(Variable = "Employment Level")
names(employ) <- c("fips","year_quarter","value","Variable")
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .99))
wage <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_avg_wkly_wage_pct_chg) %>%
filter(oty_avg_wkly_wage_pct_chg>=quant_01 & oty_avg_wkly_wage_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "Average Weekly Wage")
names(wage) <- c("fips","year_quarter","value","Variable")
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .99))
contrib <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_contributions_pct_chg) %>%
filter(oty_qtrly_contributions_pct_chg>=quant_01 & oty_qtrly_contributions_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "UI Contributions")
names(contrib) <- c("fips","year_quarter","value","Variable")
##########################################################################
rbind(employ,estab,wage,contrib)
dynamic <- rbind(employ,estab,wage,contrib)
plot <- plot_usmap(data = dynamic,
values = "oty_avg_wkly_wage_pct_chg",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Over-the-Year Percent Change in Quarterly Average Wage, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot <- plot_usmap(data = dynamic,
values = "value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Over-the-Year Percent Change in Quarterly Average Wage, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot(plot)
plot <- plot_usmap(data = na.omit(dynamic),
values = "value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot(plot)
contrib$relative_value <- 0
contrib$relative_value <- 0
contrib$relative_value[contrib$value>quant_99] <- 1
contrib$relative_value[contrib$value>0 &contrib$value<=quant_99] <-  contrib$value/quant_99
contrib$relative_value[contrib$value<quant_01] <- -1
contrib$relative_value[contrib$value<0 &contrib$value>=quant_01] <-  -1*contrib$value/quant_01
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .99))
contrib <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_contributions_pct_chg) %>%
filter(oty_qtrly_contributions_pct_chg>=quant_01 & oty_qtrly_contributions_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "UI Contributions")
names(contrib) <- c("fips","year_quarter","value","Variable")
contrib$relative_value <- 0
contrib$relative_value[contrib$value>quant_99] <- 1
contrib$relative_value[contrib$value>0 &contrib$value<=quant_99] <-  contrib$value/quant_99
contrib$relative_value[contrib$value<quant_01] <- -1
contrib$relative_value[contrib$value<0 &contrib$value>=quant_01] <-  -1*contrib$value/quant_01
contrib <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_contributions_pct_chg) %>%
filter(oty_qtrly_contributions_pct_chg>=quant_01 & oty_qtrly_contributions_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "UI Contributions")
names(contrib) <- c("fips","year_quarter","value","Variable")
contrib$relative_value <- 0
contrib$relative_value[contrib$value>quant_99] <- 1
contrib$relative_value[contrib$value>0 &contrib$value<=quant_99] <-  contrib$value[contrib$value>0 &contrib$value<=quant_99]/quant_99
contrib$relative_value[contrib$value<quant_01] <- -1
contrib$relative_value[contrib$value<0 &contrib$value>=quant_01] <-  -1*contrib$value[contrib$value<0 &contrib$value>=quant_01]/quant_01
hist(contrib$relative_value)
# Ben Glasner
# Quarterly Census of Employment and Wages Analysis Code
##################
###  Library   ###
##################
library(dplyr)
library(usmap)
library(ggplot2)
library(ggforce)
library(ggthemes)
library(gganimate)
library(gifski)
library(scales)
# devtools::install_github("keberwein/blscrapeR", force = TRUE)
library(blscrapeR)
#################
### Set paths ###
#################
if(Sys.info()[["user"]]=="bglasner"){
# Root folder
path_project <- "C:/Users/bglasner/Dropbox"
}
if(Sys.info()[["user"]]=="bngla"){
# Root folder
path_project <- "C:/Users/bngla/Dropbox"
}
if(Sys.info()[["user"]]=="Benjamin Glasner"){
# Root folder
path_project <- "C:/Users/Benjamin Glasner/Dropbox"
}
# Path to saved cohort data
path_qcew <- paste0(path_project,"/GitHub/QCEW")
setwd(path_qcew)
##################################
## QCEW Data Pull
# https://www.bls.gov/cew/about-data/downloadable-file-layouts/quarterly/naics-based-quarterly-layout.htm
data_2022 <- list()
data_2021 <- list()
data_2020 <- list()
data_2019 <- list()
data_2018 <- list()
for(i in 1:2){
data_2022[[i]] <- qcew_api(year = 2022,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2021[[i]] <- qcew_api(year = 2021,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2020[[i]] <- qcew_api(year = 2020,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2019[[i]] <- qcew_api(year = 2019,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
for(i in 1:4){
data_2018[[i]] <- qcew_api(year = 2018,
qtr=paste(i),
slice="industry", # "industry", "area", or "size."
sliceCode=10) %>%
mutate(fips = area_fips) %>%
filter(own_code == 5)
}
QCEW <- rbind(do.call(rbind, data_2022),
do.call(rbind, data_2021),
do.call(rbind, data_2020),
do.call(rbind, data_2019),
do.call(rbind, data_2018))
##########################################################################
# Animated map of establishments
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .99))
estab <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_estabs_pct_chg) %>%
# filter(oty_qtrly_estabs_pct_chg>quant_01 & oty_qtrly_estabs_pct_chg<quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "Count of Establishments")
names(estab) <- c("fips","year_quarter","value","Variable")
estab$relative_value <- 0
estab$relative_value[estab$value>quant_99] <- 1
estab$relative_value[estab$value>0 &estab$value<=quant_99] <-  estab$value[estab$value>0 &estab$value<=quant_99]/quant_99
estab$relative_value[estab$value<quant_01] <- -1
estab$relative_value[estab$value<0 &estab$value>=quant_01] <-  -1*estab$value[estab$value<0 &estab$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .99))
employ <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_month2_emplvl_pct_chg) %>%
# filter(oty_month2_emplvl_pct_chg>=quant_01 & oty_month2_emplvl_pct_chg<=quant_99) %>%
na.omit() %>%
distinct()  %>%
mutate(Variable = "Employment Level")
names(employ) <- c("fips","year_quarter","value","Variable")
employ$relative_value <- 0
employ$relative_value[employ$value>quant_99] <- 1
employ$relative_value[employ$value>0 &employ$value<=quant_99] <-  employ$value[employ$value>0 &employ$value<=quant_99]/quant_99
employ$relative_value[employ$value<quant_01] <- -1
employ$relative_value[employ$value<0 &employ$value>=quant_01] <-  -1*employ$value[employ$value<0 &employ$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .99))
wage <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_avg_wkly_wage_pct_chg) %>%
# filter(oty_avg_wkly_wage_pct_chg>=quant_01 & oty_avg_wkly_wage_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "Average Weekly Wage")
names(wage) <- c("fips","year_quarter","value","Variable")
wage$relative_value <- 0
wage$relative_value[wage$value>quant_99] <- 1
wage$relative_value[wage$value>0 &wage$value<=quant_99] <-  wage$value[wage$value>0 &wage$value<=quant_99]/quant_99
wage$relative_value[wage$value<quant_01] <- -1
wage$relative_value[wage$value<0 &wage$value>=quant_01] <-  -1*wage$value[wage$value<0 &wage$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .99))
contrib <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_contributions_pct_chg) %>%
# filter(oty_qtrly_contributions_pct_chg>=quant_01 & oty_qtrly_contributions_pct_chg<=quant_99) %>%
na.omit() %>%
distinct() %>%
mutate(Variable = "UI Contributions")
names(contrib) <- c("fips","year_quarter","value","Variable")
contrib$relative_value <- 0
contrib$relative_value[contrib$value>quant_99] <- 1
contrib$relative_value[contrib$value>0 &contrib$value<=quant_99] <-  contrib$value[contrib$value>0 &contrib$value<=quant_99]/quant_99
contrib$relative_value[contrib$value<quant_01] <- -1
contrib$relative_value[contrib$value<0 &contrib$value>=quant_01] <-  -1*contrib$value[contrib$value<0 &contrib$value>=quant_01]/quant_01
##########################################################################
dynamic <- rbind(employ,estab,wage,contrib)
##########################################################################
plot <- plot_usmap(data = na.omit(dynamic),
values = "relative_value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Relative Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
transition_time(year_quarter) +
ease_aes('linear')
plot <- plot_usmap(data = na.omit(dynamic),
values = "relative_value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Relative Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot(plot)
table(dynamic$relative_value)
View(dynamic)
##########################################################################
# Animated map of establishments
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_estabs_pct_chg,probs = .99))
estab <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_estabs_pct_chg) %>%
# filter(oty_qtrly_estabs_pct_chg>quant_01 & oty_qtrly_estabs_pct_chg<quant_99) %>%
distinct() %>%
mutate(Variable = "Count of Establishments")
names(estab) <- c("fips","year_quarter","value","Variable")
estab$relative_value <- 0
estab$relative_value[estab$value>quant_99] <- 1
estab$relative_value[estab$value>0 &estab$value<=quant_99] <-  estab$value[estab$value>0 &estab$value<=quant_99]/quant_99
estab$relative_value[estab$value<quant_01] <- -1
estab$relative_value[estab$value<0 &estab$value>=quant_01] <-  -1*estab$value[estab$value<0 &estab$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_month2_emplvl_pct_chg,probs = .99))
employ <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_month2_emplvl_pct_chg) %>%
# filter(oty_month2_emplvl_pct_chg>=quant_01 & oty_month2_emplvl_pct_chg<=quant_99) %>%
distinct()  %>%
mutate(Variable = "Employment Level")
names(employ) <- c("fips","year_quarter","value","Variable")
employ$relative_value <- 0
employ$relative_value[employ$value>quant_99] <- 1
employ$relative_value[employ$value>0 &employ$value<=quant_99] <-  employ$value[employ$value>0 &employ$value<=quant_99]/quant_99
employ$relative_value[employ$value<quant_01] <- -1
employ$relative_value[employ$value<0 &employ$value>=quant_01] <-  -1*employ$value[employ$value<0 &employ$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_avg_wkly_wage_pct_chg,probs = .99))
wage <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_avg_wkly_wage_pct_chg) %>%
# filter(oty_avg_wkly_wage_pct_chg>=quant_01 & oty_avg_wkly_wage_pct_chg<=quant_99) %>%
distinct() %>%
mutate(Variable = "Average Weekly Wage")
names(wage) <- c("fips","year_quarter","value","Variable")
wage$relative_value <- 0
wage$relative_value[wage$value>quant_99] <- 1
wage$relative_value[wage$value>0 &wage$value<=quant_99] <-  wage$value[wage$value>0 &wage$value<=quant_99]/quant_99
wage$relative_value[wage$value<quant_01] <- -1
wage$relative_value[wage$value<0 &wage$value>=quant_01] <-  -1*wage$value[wage$value<0 &wage$value>=quant_01]/quant_01
##########################################################################
# oty_qtrly_estabs_pct_chg, oty_taxable_qtrly_wages_pct_chg, oty_qtrly_contributions_pct_chg
quant_01 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .01))
quant_99 <- as.numeric(quantile(QCEW$oty_qtrly_contributions_pct_chg,probs = .99))
contrib <- QCEW %>% mutate(year_quarter = year + qtr/4) %>%
select(fips,year_quarter,
oty_qtrly_contributions_pct_chg) %>%
# filter(oty_qtrly_contributions_pct_chg>=quant_01 & oty_qtrly_contributions_pct_chg<=quant_99) %>%
distinct() %>%
mutate(Variable = "UI Contributions")
names(contrib) <- c("fips","year_quarter","value","Variable")
contrib$relative_value <- 0
contrib$relative_value[contrib$value>quant_99] <- 1
contrib$relative_value[contrib$value>0 &contrib$value<=quant_99] <-  contrib$value[contrib$value>0 &contrib$value<=quant_99]/quant_99
contrib$relative_value[contrib$value<quant_01] <- -1
contrib$relative_value[contrib$value<0 &contrib$value>=quant_01] <-  -1*contrib$value[contrib$value<0 &contrib$value>=quant_01]/quant_01
##########################################################################
dynamic <- rbind(employ,estab,wage,contrib)
##########################################################################
plot <- plot_usmap(data = na.omit(dynamic),
values = "relative_value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Relative Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot(plot)
plot <- plot_usmap(data = dynamic,
values = "relative_value",
size = .1)  +
scale_fill_gradient2(name    = "Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Relative Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .)
plot(plot)
plot <- plot_usmap(data = dynamic,
values = "relative_value",
size = .1)  +
scale_fill_gradient2(name    = "Relative Percent Change",
low = "red",
mid = "white",
high = "forestgreen",
midpoint = 0) +
theme(legend.position = "right",
plot.title = element_text(size=14),
legend.title = element_text(size=12),
panel.background = element_rect(color = "transparent",
fill = "transparent")) +
labs(title = "Relative Over-the-Year Percent Change, Private Workers",
subtitle = 'Year - {as.integer(frame_time)}') +
facet_wrap(Variable ~ .) +
transition_time(year_quarter) +
ease_aes('linear')
animate(plot,
height = 5,
width = 8.5,
units = "in",
res = 150,
end_pause = 10,
renderer = gifski_renderer())
View(dynamic)
